<!doctype html><html><head><meta charset=utf-8><title>200V piezo crystal driver - mattoppenheim</title><meta name=pinterest content="nopin"><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><link rel="dns-prefetch preconnect" href=https://fonts.gstatic.com crossorigin><link rel="dns-prefetch preconnect" href=https://use.fontawesome.com crossorigin><meta name=theme-color content="#263238"><meta name=generator content="Hugo 0.107.0"><link rel=apple-touch-icon href=https://mattoppenheim.github.ioimages/logo.png><meta name=description content="Spoiler alert: I got the driving circuitry to behave as planned, but I could not feel the crystal vibrate.
The idea is to use the tiny crystals used in piezoelectric motors to create an array of dots that can be made to vibrate under the area of a finger tip. This will be used to create a tactile display that can be felt. The initial aim would be an array of these crystals under an area the size of your fingertip."><meta property="og:title" content="200V piezo crystal driver - mattoppenheim"><meta property="og:type" content="article"><meta property="og:url" content="https://mattoppenheim.github.io/page/2019/01/200v-piezo-crystal-driver/"><meta property="og:image" content="https://mattoppenheim.github.io/images/default.png"><meta property="og:site_name" content="mattoppenheim"><meta property="og:description" content="Spoiler alert: I got the driving circuitry to behave as planned, but I could not feel the crystal vibrate.
The idea is to use the tiny crystals used in piezoelectric motors to create an array of dots that can be made to vibrate under the area of a finger tip. This will be used to create a tactile display that can be felt. The initial aim would be an array of these crystals under an area the size of your fingertip."><meta property="og:locale" content="ja_JP"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="mattoppenheim"><meta name=twitter:url content="https://mattoppenheim.github.io/page/2019/01/200v-piezo-crystal-driver/"><meta name=twitter:title content="200V piezo crystal driver - mattoppenheim"><meta name=twitter:description content="Spoiler alert: I got the driving circuitry to behave as planned, but I could not feel the crystal vibrate.
The idea is to use the tiny crystals used in piezoelectric motors to create an array of dots that can be made to vibrate under the area of a finger tip. This will be used to create a tactile display that can be felt. The initial aim would be an array of these crystals under an area the size of your fingertip."><meta name=twitter:image content="https://mattoppenheim.github.io/images/default.png"><script type=application/ld+json>{"@context":"http://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mattoppenheim.github.io"},"headline":"200V piezo crystal driver-mattoppenheim","image":{"@type":"ImageObject","url":"https:\/\/mattoppenheim.github.io\/images\/default.png","height":800,"width":800},"datePublished":"2019-01-04T00:00:00JST","dateModified":"2019-01-04T00:00:00JST","author":{"@type":"Person","name":"mattoppenheim"},"publisher":{"@type":"Organization","name":"mattoppenheim","logo":{"@type":"ImageObject","url":"https:\/\/mattoppenheim.github.ioimages/logo.png","width":600,"height":60}},"description":"Spoiler alert: I got the driving circuitry to behave as planned, but I could not feel the crystal vibrate.\nThe idea is to use the tiny crystals used in piezoelectric motors to create an array of dots that can be made to vibrate under the area of a finger tip. This will be used to create a tactile display that can be felt. The initial aim would be an array of these crystals under an area the size of your fingertip."}</script><link rel=canonical href=https://mattoppenheim.github.io/page/2019/01/200v-piezo-crystal-driver/><link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,700" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css crossorigin=anonymous><style>html{font-size:18px;background-color:rgba(236,239,241,.5)}@media(max-width:768px){html{font-size:15px}}body{color:#333;font-family:roboto slab,ヒラギノ角ゴ pro w3,hiragino kaku gothic pro,メイリオ,Meiryo,sans-serif;font-feature-settings:"palt";font-size:inherit;line-height:1rem;margin:0;padding:0}h1,h2,h3,h4,h5,h6{font-size:1rem;font-weight:700;line-height:1rem;margin:0}hr{border:0;border-top:1px dashed #cfd8dc;margin:1rem 0}p{margin:0;line-height:1rem}a{color:#2196f3;text-decoration:none;transition-duration:.3s}ul,ol{margin:0;padding:0}table{border-collapse:collapse;display:block;overflow-x:auto}th,td{font-size:.8rem;padding:.5rem}tr{border-bottom:1px dashed #ddd}main,aside{display:block}main{padding:1rem 0 3rem}.l-container{position:relative;max-width:68rem;margin:0 auto;padding:0 1rem}.l-container.thin{max-width:44rem}.l-header{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);padding:1rem 0;text-align:center}.l-header .description{margin-top:.5rem;font-size:.8rem}.l-footer{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);font-size:.6rem;font-weight:700;padding:1rem 0}.l-sidebar{margin:-1rem 0}@media(max-width:768px){.l-sidebar{margin-top:4rem}}.mrow{margin:0 -1rem;overflow:hidden}.mcol{box-sizing:border-box;float:left;padding:0 1rem}.c6{width:50%}.c4{width:33.26323833%}.c8{width:66.66666%}@media(max-width:768px){.mcol{width:100%;float:none}}.logo a{font-size:1.4rem;line-height:1.5rem;font-weight:700;color:#333}.articles{margin:-1rem 0;margin-bottom:1rem}.articles.sm{margin:-.5rem 0;margin-bottom:0}article{border-radius:4px;overflow:hidden}article.li{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);height:20rem;overflow:hidden;margin:1rem 0}article.li>a{display:block;color:#333}article.li .inner{padding:1rem}article.li .thumb{height:8rem}article.li .title{color:#333;font-size:1.2rem;line-height:1.5rem;margin-bottom:.5rem}article.li .summary{font-size:.8rem;height:6rem;overflow:hidden;margin-top:1rem}article.li .summary::after{content:'...'}article.lism{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);margin:.5rem 0}article.lism::after{content:'';display:block;clear:both}article.lism>a{display:block;color:#333}article.lism .inner{display:table-cell;vertical-align:middle;height:5rem;padding:0 .75rem}article.lism .thumb{width:5rem;height:5rem;float:left}article.lism .title{font-weight:700;font-size:.8rem;margin-bottom:.25rem}article.sn{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);margin-bottom:1rem}article.sn .thumb{height:20rem}@media(max-width:768px){article.sn .thumb{height:10rem}}article.sn>.article-header,article.sn>.article-body,article.sn .article-footer{padding:2rem}article.sn>.article-body{padding:0 2rem}@media(max-width:768px){article.sn>.article-header,article.sn>.article-body,article.sn .article-footer{padding:1rem}article.sn>.article-body{padding:0 1rem}}article.sn>.article-header .title{font-size:1.8rem;line-height:2rem;margin-bottom:.5rem}@media(max-width:768px){article.sn>.article-header .title{font-size:1.4rem;line-height:1.5rem}}article.sn>.article-header .facts{margin-bottom:1rem}article.sn>.article-body{margin-bottom:1.5rem}article.sn>.article-body h2{border-bottom:.25rem solid #333;font-size:1.2rem;line-height:1.5rem;margin:1.5rem 0;padding:.5rem 0}article.sn>.article-body h3{border-left:.5rem solid #333;line-height:1.5rem;margin:1.5rem 0;padding:.125rem .5rem}article.sn>.article-body ul,article.sn>.article-body ol{margin:1.5rem 0;padding-left:1.5rem}article.sn>.article-body li{padding-bottom:.5rem;line-height:1.5rem}article.sn>.article-body li:last-child{padding-bottom:0}article.sn>.article-body p{margin:1rem 0;line-height:1.5rem}article.sn>.article-body strong,article.sn>.article-body em{font-style:normal;font-weight:700}article.sn>.article-body strong{box-shadow:0 -.5rem #ffc107 inset}article.sn>.article-body em{color:#8bc34a}article.sn>.article-body h2 code{font-size:1.1rem}article.sn>.article-body h1 code,article.sn>.article-body h3 code,article.sn>.article-body h4 code,article.sn>.article-body h5 code,article.sn>.article-body h6 code{font-size:.9rem}article.sn>.article-body code,article.sn>.article-body pre{font-family:Menlo,Consolas,monospace;font-size:.7rem}article.sn>.article-body pre{background-color:#333;color:#fff;line-height:1rem;margin:1.5rem -2rem;overflow:auto}@media(max-width:768px){article.sn>.article-body pre{margin:1.5rem -1rem}}article.sn>.article-body pre>code{display:block;padding:1rem 2rem}@media(max-width:768px){article.sn>.article-body pre>code{padding:1rem}}article.sn>.article-body p code,article.sn>.article-body h1 code,article.sn>.article-body h2 code,article.sn>.article-body h3 code,article.sn>.article-body h4 code,article.sn>.article-body h5 code,article.sn>.article-body h6 code,article.sn>.article-body li code{background-color:#eceff1;color:#333;border-radius:4px;margin:0 .25rem;padding:.375rem;white-space:nowrap}article.sn>.article-body blockquote{position:relative;border-left:.25rem solid #333;font-size:.8rem;padding:.125rem 1rem;margin:1.5rem 0}@media(max-width:768px){article.sn>.article-body blockquote{font-size:1rem}}article.sn>.article-body blockquote p{margin:.5rem 0;line-height:1rem}article.sn>.article-body figure{margin:1.5rem 0}article.sn>.article-body img,article.sn>.article-body figure img,article.sn>.article-body figure amp-img{box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);max-width:100%;height:100%}article.sn>.article-body figcaption{color:#cfd8dc;font-size:.8rem;font-weight:700;margin-top:.5rem}.facts li{display:inline;font-size:.8rem;margin-right:1rem}.facts i{color:#cfd8dc;margin-right:.5em}.facts.sm li{font-size:.7rem}section.sidebar{margin:2rem 0}section.sidebar>header{font-size:.8rem;font-weight:700;letter-spacing:4px;text-align:center;margin:1.5rem 0}section.footer{margin:1rem 0}section.footer>header{font-size:.8rem;margin:.5rem 0}section.footer>header::before{content:"- "}section.footer>header a{font-weight:700;color:#333;text-decoration:underline}.terms{margin:-.25rem}.terms li{display:inline-block}.terms a{display:block;float:left;background-color:#333;border-radius:4px;color:#fff;font-size:.7rem;margin:.25rem;padding:0 .75rem;line-height:1.75rem}.paging{text-align:center;padding:1rem 0}.paging a{display:inline-block;background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);border-radius:4px;color:#333;padding:0 1rem;line-height:3rem}.page-title{text-align:center;margin:1rem 0}.page-title::after{content:'';display:block;border-bottom:.25rem solid #333;width:3rem;margin:1.5rem auto}.page-title>.title{font-size:1.2rem;line-height:1.5rem}.share{padding:0}.share a{display:inline-block;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);min-width:1rem;height:2rem;border-radius:4px;color:#333;font-size:.8rem;font-weight:700;line-height:2rem;text-align:center;padding:0 .5rem}.adj article.lism{margin-bottom:1rem}.adj header{font-weight:700;font-size:.8rem}.toc{padding:0 2rem;margin:1rem 0}.toc nav>ul{background-color:#eceff1;border-radius:4px;display:inline-block;font-size:.8rem;padding:.5rem 1rem;word-break:break-all;list-style:none}.toc ul{padding:0}.toc ul ul{padding-left:1rem}.toc ul ul>li{font-weight:700;margin:.5rem 0;list-style-type:decimal}.toc ul ul ul{padding-left:1rem}.toc ul ul ul>li{list-style-type:disc;font-weight:500}.toc li{color:#90a4ae}@media(max-width:768px){.toc{padding:0 1rem}}.thumb{background-image:url(https://mattoppenheim.github.io/images/default.jpg);background-size:cover;background-position:50%}</style></head><body><header class=l-header><h1 class=logo><a href=https://mattoppenheim.github.io>mattoppenheim</a></h1></header><main><div class=l-container><div class=mrow><div class="mcol c8"><article class=sn><div class="thumb thumb-a71a9bbb95020e8e63bd60a9debb5d2f"></div><header class=article-header><h1 class=title>200V piezo crystal driver</h1><ul class=facts><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=2019-01-04T00:00:00JST>Jan 4, 2019</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i><a href=https://mattoppenheim.github.iopage/>PAGE</a></li></ul><aside class=share><a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&title=200V%20piezo%20crystal%20driver" title=はてなブックマーク class=ht target=_blank rel="noopener nofollow">B!</a>
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&text=200V%20piezo%20crystal%20driver&tw_p=tweetbutton" title=Twitterでシェア class=tw target=_blank rel="noopener nofollow"><i class="fab fa-twitter" aria-hidden=true></i></a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&t=200V%20piezo%20crystal%20driver" title=Facebookでシェア class=fb target=_blank rel="noopener nofollow"><i class="fab fa-facebook" aria-hidden=true></i></a>
<a href="https://getpocket.com/edit?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&title=200V%20piezo%20crystal%20driver" title=Pocketに保存 class=pk target=_blank rel="noopener nofollow"><i class="fab fa-get-pocket" aria-hidden=true></i></a>
<a href="https://social-plugins.line.me/lineit/share?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f" title=LINEでシェア class=ln target=_blank rel="noopener nofollow"><i class="fab fa-line" aria-hidden=true></i></a></aside></header><div class=article-body><p>Spoiler alert: I got the driving circuitry to behave as planned, but I could not feel the crystal vibrate.</p><p>The idea is to use the tiny crystals used in <a href=https://en.wikipedia.org/wiki/Piezoelectric_motor>piezoelectric motors</a> to create an array of dots that can be made to vibrate under the area of a finger tip. This will be used to create a tactile display that can be felt. The initial aim would be an array of these crystals under an area the size of your fingertip. This would enable things like a Braille or Moon display that can be felt under your finger and that updates real time.</p><p>The crysals came from <a href=https://pcbmotor.com/>pcbmotor</a>. These crystals are polarised, so I soldered the gold side to the where the +ve signal will come from. I could measure the capacitance of the crystals through the pins on the adapter board (disconnected from the breadboard, as breadboard has lots of capacitance) at around 10pF. Measuring capacitance this small is difficult with my cheapo eBay sourced meter. But it is a sanity check that I have something soldered down that has the electronic characteristics I expect.</p><p>A single crystal soldered to some flying leads can be seen in the photo below. The green adapter board allows the crystals to be mounted on a breadboard for experimentation.</p><p><img src=images/2019_1_07_piezo_flying_leads_mount.jpg alt></p><p>Piezo transducer mounted on flying leads.</p><p>Two of these crystals can be seen soldered onto the bottom row of pads at the left of an adapter board below.</p><p><img src=images/2018_1_03_piezo_crystals.jpg alt></p><p>Two piezo electric crystals mounted on the bottom left of an adapter board.</p><p>I checked on the piezo crystal polarity by connecting the pins that they are connected to on theiradapter board to a Tektronix DMM 4050 6 1/2 digit precision multimeter. When I pressed on top of the crystals with a pencil rubber, I could see an inital potential of around +10mV when the cables were connected with the positive and negative the way I think that the crystal is polarised. This deflection is reversed when I connect the cables with opposite polarity. This verifies that the crystal is alive and that it has a connection to the pins.</p><p>These crystals are designed to resonate at around 40-42 kHz. Now, you won&rsquo;t feel something vibrating at this high a frequency. Your touch is sensitive to vibrations of around 10-100 Hz. So the crystals need to be driven with a frequency of around 40 kHz, which is then switched on and off (modulated in engineering speak) at around 30 Hz. All of this with a voltage amplitude of around 100 V RMS (200 V peak to peak for a square wave). How hard could that be? Errrr&mldr;.</p><p>I built a 100 V power supply in another post <a href="https://mattoppenheim.com/2018/10/23/using-the-drv8662-chip-to-get-105v-from-battery-voltage/?preview_id=752&preview_nonce=39c0072351&preview=true">here</a>. To get a higher voltage I used two Rohde & Schwarz HMP4040 adjustable power supplies I found in the lab. I read the supply&rsquo;s manual online to check that the outputs could be connected in serial safely. I ended up with an output of around a 220 V. The power supplies allow for the current output to be limited, which is a good safety feature when prototyping.</p><p>How to create a 40-42 kHz output signal which is then switched on and off at about 30-50 Hz? I used an N-channel MOSFET (FET) to switch a low voltage signal, with the gate of the transistor operated by an operational amplifier (op amp). The op amp input comes from an external microcontroller. I thought of lashing something up to create this input using a <a href=https://www.microbit.org/>BBC micro:bit</a>. Then I hosed money at the problem until it went away and bought an <a href=https://store.digilentinc.com/analog-discovery-2-100msps-usb-oscilloscope-logic-analyzer-and-variable-power-supply/>Analog Discovery 2</a> gizmo with a built in waveform generator. The software for the Analog Discovery allows for signals to be modulated, so I could easily create got the driving signal I was after. There are a range of YouTube videos to get you started with the Analog Discovery 2.</p><p>Why use an op-amp to switch the gate of the FET? A FET needs a certain amount of charge applied to the gate before it will fully open. An op-amp has the &lsquo;oomph&rsquo; to supply the necessary charge to fully open the FET quickly.</p><p>Top tip. Run the Analog Discovery from a laptop and disconnect the laptop from the mains when connecting the Analog Discovery 2 to your circuit. I measured the potential difference between the ground on the Analog Discovery 2 and my circuit and it was around 0.06V with the laptop connected to mains power. When running on battery, the potential difference was a magnitude lower. This means there is less chance of a &lsquo;ground loop&rsquo; cooking off your laptop when you connect the ground of the Analog Discover 2 waveform generator to the ground of your circuit board.</p><p>I simulated the circuit using the <a href=http://falstad.com/circuit/circuitjs.html>Falstad</a> and <a href=https://www.analog.com/en/design-center/design-tools-and-calculators/ltspice-simulator.html>ltspice</a> simulators. Simulate twice, build once as my Grandma used to say. I tried the <a href=http://qucs.sourceforge.net/>qucs</a> simulator as well, but could not get it to &lsquo;converge&rsquo; with my design. Probably something I&rsquo;m doing wrong.</p><p>Falstad is not as accurate or configurable as Ltspice but is more interactive. The two packages are designed for different applications, but their functionality overlaps. Falstad runs through the browser. I found a downloadable version of Falstad called Circuit Simulator <a href=https://github.com/CEBA77/circuitjs1>here</a>. This is useful for me as when I am travelling to and from survey ships on supply vessels, the internet access is often limited. I&rsquo;m grateful for these simulators being made available.</p><p>A screen grab from Falstad/Circuit Simulator can be seen below. I use a CA3140 CMOS op-amp as I found a few of them in the lab and they are fit for purpose. The FET is a 450V rated N-channel SSN1N45B (farnell p/n 2454128). This FET can handle the voltage that I need to use and can be switched on and off with a reasonably low voltage swing to the gate.</p><p><img src=images/piezo_driver_falstad-1024x627.jpg alt></p><p>Falstad simulation of the piezo driver. The piezo crystal is represented by the 20pF capacitor.</p><p>The full experimental set up can be seen below. The breadboard with the piezo crystals, FET and op-amp is in the foreground. The Analog Discovery 2 which generates the modulated driving signal is the green box to the right of the breadboad. The Analog Discovery 2 is powered and controlled by the laptop, running the Waveforms software to control the Analog Discovery 2. Behind the laptop are two beige Rohde and Shwarz HMP4040 power supplies. The outputs from these are connected in serial to create the 220+V high voltage power rail. The two sockets on the top left power supply are separate from this and output around 8V to power the op-amp with. In the background there is a Tektronix TBS1104 oscilloscope. You can see the mess of 4mm banana plug red, black, blue and green cables needed to power the circuit and feed signals from the Analog Discovery 2. It is hard to find enough of these cables in any lab, so I keep a stash of my own.</p><p><img src=images/2018_1_03_experimental_setup-1024x584.jpg alt></p><p>Piezo driver breadboard circuit, power supplies, signal generator and &lsquo;scope.</p><p>A photo showing the breadboard assembly is shown below. The op-amp is on the bottom left. The FET is to the right of this. I added a diode to protect the FET from back EMF. There are mutiple resistors instead of the single resistor shown in the Falstad schematic. The resistors are each rated to 0.25W. Daisy chaining several smaller value resistors instead of using a single large value ensures that the power rating of the resistors is not exceeded. Otherwise they emit magic smoke and don&rsquo;t work any more. I added a couple of LEDs to show when the op-amp is powered on and when the high voltage rail is live. A couple of black oscilloscope probes connected to the FET gate and to the input to the piezo crystals can be seen on the bottom of the image. Having the 4mm sockets for the breadboard is useful - otherwise you end up with a mess of crocodile clips which inevitably touch and short each other.</p><p><img src=images/2018_1_03_breadboard_setup-1024x715.jpg alt></p><p>Piezo driver breadboard circuit. The piezo crystals are on the green board.</p><p>An example &lsquo;scope grab from a Tektronix TBS1104 is shown below. The orange trace is the signal from the Analog Discovery 2 board used as the input to the non-inverting port of the op-amp. The output from this op-amp switches the FET on and off. The green trace is the voltage at the high side of the piezo crystal. In this display, the driving voltage is 212V peak to peak, which is 106V RMS for a square wave. The dense bursts of signal are the 40kHz driver, the larger gaps show that this is being switched on and off at around 30Hz. The signal frequency on the &lsquo;scope is shown as 6.250kHz, with a question mark, as the modulation of the 40kHz with the 30Hz signal confuses the &lsquo;scope&rsquo;s frequency measurement.</p><p><img src=images/TEK0014.jpg alt></p><p>piezo driver signal, 40kHz moudulated at 30Hz</p><p>The &lsquo;scope grab below shows a close up of the gate driver where I try 41kHz as driving frequency for the piezo crystal. We can see that the FET gate is being driven with a 7.6V peak to peak square wave, which enables the 226V high voltage rail to be switched to generate the piezo driver signal. I tried a few frequencies to try and get the crystal to resonate. The gate of the FET needs around 7.5V peak to peak to &lsquo;open&rsquo; the FET enough for the full 226V to switch through it. With a lower high voltage supply, a lower FET gate voltage is needed. I spent a few years trying to study physics, so did at one time have a good understanding of all the semiconductor shenanigans that go on inside the transistor. That was a long time ago.</p><p><img src=images/TEK0015.jpg alt></p><p>piezo driving signal, 41kHz</p><p>We can see that when the FET gate goes high, the piezo driving voltage goes low. This is as the FET is opened by the gate going high, which connects the drain to source to ground through the 300Ohm resistor. This pulls the voltage low. When the gate signal is low, the FET is closed, so the high voltage rail is measured at the piezo crystal.</p><p>I messed around with some transformers to generate the piezo driving signal with limited result. I could wind a transformer of my own, but would rather use something off the shelf. I tried a few from <a href=https://www.coilcraft.com/>coilcraft</a> but without success. You need to be careful with transformers, as their impedance changes with frequency, meaning you can end up putting more current through them than their windings are designed for if you&rsquo;re not careful, as shown by <a href="https://www.youtube.com/watch?v=sFTjFD84Q1c">Electroboom</a>.</p><p>I am waiting on a couple of high voltage op-amp samples from <a href=https://www.analog.com/en/index.html>analog devices</a> to play with. However, if I can&rsquo;t feel the crystals vibrating with the FET circuit, I don&rsquo;t see why I should feel them shake with a high voltage op-amp circuit either.</p><p>Something I could try - the Analog Discover 2 has the facility to sweep a range of frequencies. I should try this from say 38kHz to 45kHz. It could be that the resonant frequency of the crystal has such a narrow band (&lsquo;high Q&rsquo;) that I&rsquo;m missing it by testing at 40, 41 and 42kHz only. I tried testing with a 10Hz modulation as I&rsquo;m informed that we are quite receptive to this frequency of vibration.</p><p>I tried soldering a crystal onto some flying leads made from wire wrap cable. This setup allows me to feel more easily if the crystal is vibrating with my fingers. I wear disposable gloves as there will be a tingling when using a bare finger otherwise -from the current passing between 220V! I suspect that initial reports of feeling a vibration using a demo board made by a PCB motor manufacturer were in from feeling current, not the crystal vibrating.</p><p>There&rsquo;s only so much time I want to pump into this. I&rsquo;ve spent too much time over the years holding onto projects that were never going to work with hindsight. On t&rsquo;other hand, you don&rsquo;t want to miss finding your pot of gold by not digging the last hole at the end of the rainbow. This may not be a good analogy.</p><p>Skills I revised during this project: basic transistor and op-amp circuit design. I got to grips with the basics of LTSpice as well, something I&rsquo;ve wanted to do for a while.</p><h2 id=april-2019-update>April 2019 Update</h2><p>I bought a 0.001mm resolution micrometer to see if I could measure a change in size of the crystal when I hit it with the 220V peak to peak signal. I could convince myself there is a 0.005mm deformation, but this may be &lsquo;confirmation bias&rsquo; as the experimental arrangement is not ideal. Trying to use a micrometer gauge on a crystal with flying led to the leads being torn off by the micrometer plates. So I soldered a crystal down. Then I realised that the micrometer plates would short out the two sides of the crystal. So I painted the crystal. Still conductive. So I coated it in clear nail varnish. This seemed to do the trick. But getting an accurate measurement is not easy.</p><p>I also rejigged the circuit so that one side of the crystal is held at +100V, while the other side is pulled from 0 to 220V. This means that the crystal plate connected to the varying voltage will see a swing of -100V to +110V compated with the side held at+100V. I hoped this would make the crystal expand and contract in a more tactile manner. No joy. The Falstad circuit simulation for this is shown below. The code for this can be found at the end of the article.</p><p><img src=images/fet_switch_falstad-1024x967.png alt></p><p>Modified piezo crystal driving circuit simulated in Falstad.</p><p>I created a driving signal that sweeps from 38kHz to 42kHz (which I call a &lsquo;chirp&rsquo;), modulated at 10Hz, to increase the chance of the crystal resonating at some point in the sweep.</p><p>The Analog Discovery 2 from Digilent can be set up to produce this modulated chirp signal. One of the two waveform channels on the Discovery 2 board creates a &lsquo;chirp&rsquo; that sweeps from 28kHz to 42kHz. This is set to start on an external trigger. This external trigger is generated by using the second waveform channel, which is configured as a 10Hz square wave. Be sure to DC offset the waveform signals to be above ground, as by default they are symmetrical +/- around ground. As the FET circuit only works for signals above ground, the negative signal don&rsquo;t do much. I learned this the hard way. &lsquo;Why is my transistor not turning on&rsquo;. D&rsquo;oh &lt;\Homer Simpson>.</p><p>The experimental arrangement can be seen below. The yellow crocodile clip is the +100V rail applied to the negative of the piezo crystal. This crystal is on the small board just above the yellow clip. The red plug supplies the +220V rail voltage. The black plug is ground. The green plug going into the yellow socket is +9V for the op-amp. The green plug going into the blue socket is the output from the waveform generator. The nest of resistors just below the green LED are in series with the LED, to indicate when the +220V rail is live. A number of resistors were needed to get the power per resistor below 1/4W. The resistors are only rated to this power. I found this out by wondering why I could smell something burning.</p><p>You can&rsquo;t really see the FET on this photo, it is hidden under the looping red wire on the photo. The op amp is the old-school chip on the bottom left of the breadboard.</p><p><img src=images/piezo_driving_circuit_2-1024x745.jpg alt></p><p>Piezo crystal driving circuit. The crystal is on the small board on the right of the breadboard.</p><p>Still no tactile response from the crystal. A Tektronix screen grab of the driving signal to the gate of the FET (top trace) and the voltage measured between ground and the positive side of the piezo crystal is shown below. The scale is too coarse to see that the frequencies are sweeping through a range. The display is highly aliased at the timescale shown.</p><p><img src=images/TEK0017.jpg alt></p><p>Tektronix &lsquo;scope screen grab of the chirped signal. Top is the FET driver, bottom is the signal on the piezo crystal.</p><p>What I need is the piezo crystal&rsquo;s demo board. The lecturer who started this project claims he felt a tactile response when driving this kind of piezo crystal, which is mounted on that board . If this board can be found, I will see if I can replicate the tactile sensation and take it from there. I suspect that the sensation was from the current running through the crystal, not from the crystal deforming. The amount of deformation is tiny.</p><h2 id=falstad-simulator-code-for-the-piezo-crystal-driving-circuit>Falstad simulator code for the piezo crystal driving circuit</h2><p>Just copy and paste the code into the box that comes up when you click on &lsquo;File&rsquo;, &lsquo;Import From Text&rsquo; in the <a href=http://www.falstad.com/circuit/>Falstad circuit simulator</a>.</p><p>$ 1 2.5e-9 21.593987231061412 50 5 50<br>w 448 288 560 288 0<br>w 560 480 560 496 0<br>f 448 464 560 464 0 1.5 0.02<br>R 448 288 400 288 0 0 40 200 0 0 0.5<br>g 560 560 560 608 0<br>r 192 560 192 624 0 1000<br>w 320 464 384 464 0<br>w 192 384 192 448 0<br>w 96 384 192 384 0<br>a 192 464 320 464 9 9 0 1000000 3.999920001599971 4 100000<br>w 192 480 192 528 0<br>g 96 528 96 576 0<br>v 96 528 96 384 0 2 40000 2 2 0 0.5<br>w 384 464 448 464 0<br>r 560 336 560 400 0 22000<br>w 560 288 560 336 0<br>w 560 400 560 448 0<br>c 608 400 608 496 0 2e-11 -97.19155019928473<br>r 192 528 320 528 0 1000<br>c 240 560 288 560 0 1e-11 -3.999920001256246<br>w 288 560 320 560 0<br>w 320 560 320 528 0<br>w 240 560 192 560 0<br>w 192 528 192 560 0<br>g 192 624 192 672 0<br>w 608 400 560 400 0<br>r 560 496 560 560 0 300<br>w 320 528 320 464 0<br>R 672 560 736 560 0 0 40 100 0 0 0.5<br>p 672 400 672 560 1 0<br>w 608 400 672 400 0<br>w 608 560 672 560 0<br>r 608 496 608 560 0 300<br>x 740 487 838 490 4 24 voltmeter<br>x 621 430 754 433 4 24 piezo\scrystal<br>o 16 64 0 4099 320 0.05 0 2 16 3<br>o 6 64 0 4099 10 0.00009765625 1 2 6 3<br>o 29 64 0 4098 160 0.1 2 1</p></div><footer class=article-footer><aside class=share><a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&title=200V%20piezo%20crystal%20driver" title=はてなブックマーク class=ht target=_blank rel="noopener nofollow">B!</a>
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&text=200V%20piezo%20crystal%20driver&tw_p=tweetbutton" title=Twitterでシェア class=tw target=_blank rel="noopener nofollow"><i class="fab fa-twitter" aria-hidden=true></i></a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&t=200V%20piezo%20crystal%20driver" title=Facebookでシェア class=fb target=_blank rel="noopener nofollow"><i class="fab fa-facebook" aria-hidden=true></i></a>
<a href="https://getpocket.com/edit?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f&title=200V%20piezo%20crystal%20driver" title=Pocketに保存 class=pk target=_blank rel="noopener nofollow"><i class="fab fa-get-pocket" aria-hidden=true></i></a>
<a href="https://social-plugins.line.me/lineit/share?url=https%3a%2f%2fmattoppenheim.github.io%2fpage%2f2019%2f01%2f200v-piezo-crystal-driver%2f" title=LINEでシェア class=ln target=_blank rel="noopener nofollow"><i class="fab fa-line" aria-hidden=true></i></a></aside></footer></article><div class="adj mrow"><div class="mcol c6"><header>Next Article</header><article class=lism><a href=https://mattoppenheim.github.io/page/2019/01/give-me-a-minute-set-up-and-use-instructions/><div class="thumb thumb-b315d6fef080322dd1469026f234515f"></div><div class=inner><div class=title>Give Me a Minute set up and use instructions</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=15007-01-15T00:00:00JST>Jan 15, 2019</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>PAGE</li></ul></div></a></article></div><div class="mcol c6"><header>Previous Article</header><article class=lism><a href=https://mattoppenheim.github.io/page/2018/12/christmas-cards/><div class="thumb thumb-7d255178e0ef55c40c68ef2d49be141f"></div><div class=inner><div class=title>Christmas Cards</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=20007-12-20T00:00:00JST>Dec 20, 2018</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>PAGE</li></ul></div></a></article></div></div></div><div class="mcol c4"><aside class=l-sidebar><section class=sidebar><header>LATESTS</header><div class="articles sm"><article class=lism><a href=https://mattoppenheim.github.io/post/2022/10/converting-kicad-nightly-build-to-kicad-stable/><div class="thumb thumb-a650b124ce45e26ebb7a65e2357d703b"></div><div class=inner><div class=title>Converting kicad-nightly build to kicad stable</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=12007-10-12T00:00:00JST>Oct 12, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/10/jacdac-using-the-black-magic-programmer/><div class="thumb thumb-055f630d6fb825ab775e5939e6223e0d"></div><div class=inner><div class=title>Jacdac: Using the Black Magic programmer</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=12007-10-12T00:00:00JST>Oct 12, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/05/using-microbits-to-send-data-to-and-from-an-arduino-wirelessly/><div class="thumb thumb-a5214e9b999e197bd08ef76d82293a4f"></div><div class=inner><div class=title>Using micro:bits to send data to and from an Arduino wirelessly</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=10007-05-10T00:00:00JST>May 10, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/05/logic-level-converter-between-an-arduino-and-microbit-using-a-fet-transistor/><div class="thumb thumb-2513cdb6f23eb9ce12686600f4e5e3fe"></div><div class=inner><div class=title>Logic level converter between an Arduino Uno and micro:bit using a FET transistor</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=1007-05-01T00:00:00JST>May 1, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/04/downloading-youtube-videos-using-termux-and-youtube-dl-on-android/><div class="thumb thumb-99946926ea762383b64f3640808c8ef5"></div><div class=inner><div class=title>Downloading YouTube videos using Termux and youtube-dl on Android</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=29007-04-29T00:00:00JST>Apr 29, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/04/kicad-fixing-invisible-gaps-in-board-outlines-on-the-edge-cuts-layer/><div class="thumb thumb-b8a8e92b4bd792ef7ae9e09662b62192"></div><div class=inner><div class=title>Kicad - fixing invisible gaps in board outlines on the Edge.Cuts layer</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=16007-04-16T00:00:00JST>Apr 16, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/04/installing-kicad-nightly-build-on-debian-11/><div class="thumb thumb-0aee508cb6a6c2dcc12e1d5c98ec725a"></div><div class=inner><div class=title>Installing kicad nightly-build on Debian 11</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=8007-04-08T00:00:00JST>Apr 8, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2022/02/remove-spikes-from-a-dataset-using-python/><div class="thumb thumb-0ed92fccd3e6413a138119558128b4af"></div><div class=inner><div class=title>Remove spikes from a dataset using python</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=25007-02-25T00:00:00JST>Feb 25, 2022</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2021/12/bendlabs-single-axis-bend-sensor/><div class="thumb thumb-d204e5f23fe1155f37071ecc587de825"></div><div class=inner><div class=title>Bendlabs single-axis bend sensor</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=30007-12-30T00:00:00JST>Dec 30, 2021</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article><article class=lism><a href=https://mattoppenheim.github.io/post/2021/12/mounting-an-android-phone-on-debian-linux-to-synchronise-files/><div class="thumb thumb-dcfcf5c61d3126c3fa9b237336aa9277"></div><div class=inner><div class=title>Mounting an Android phone on Debian Linux to synchronise files</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=28007-12-28T00:00:00JST>Dec 28, 2021</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>POST</li></ul></div></a></article></div></section><section class=sidebar><header>TAGS</header><ul class=terms><li><a href=https://mattoppenheim.github.iotags/microbit>microbit <span class=count>(26)</span></a></li><li><a href=https://mattoppenheim.github.iotags/python>python <span class=count>(16)</span></a></li><li><a href=https://mattoppenheim.github.iotags/microbit-2>microbit-2 <span class=count>(9)</span></a></li><li><a href=https://mattoppenheim.github.iotags/bbc-microbit>bbc-microbit <span class=count>(8)</span></a></li><li><a href=https://mattoppenheim.github.iotags/assistive-technology>assistive-technology <span class=count>(7)</span></a></li><li><a href=https://mattoppenheim.github.iotags/yotta>yotta <span class=count>(7)</span></a></li><li><a href=https://mattoppenheim.github.iotags/linux>linux <span class=count>(6)</span></a></li><li><a href=https://mattoppenheim.github.iotags/micropython>micropython <span class=count>(5)</span></a></li><li><a href=https://mattoppenheim.github.iotags/arduino>arduino <span class=count>(4)</span></a></li><li><a href=https://mattoppenheim.github.iotags/debian>debian <span class=count>(4)</span></a></li></ul></section></aside></div></div></main><footer class=l-footer><div class=l-container><p><span class=h-logo>&copy; mattoppenheim</span></p><aside><p>Powered by <a href=https://gohugo.io/>Hugo</a>.</p><p><a href=https://github.com/dim0627/hugo_theme_robust>Robust</a> designed by <a href=http://yet.unresolved.xyz/>Daisuke Tsuji</a>.</p></aside></div></footer></body></html>